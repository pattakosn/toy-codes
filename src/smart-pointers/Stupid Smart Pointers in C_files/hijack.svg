<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="763px" height="241px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.146 Safari/537.36&quot; version=&quot;8.4.2&quot; editor=&quot;www.draw.io&quot; type=&quot;browser&quot;&gt;&lt;diagram id=&quot;04d2b87c-084a-5e43-3400-521483211758&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><rect x="45" y="50" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(55.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 100px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">saved eip for main</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">saved eip for main</text></switch></g><g transform="translate(187.5,52.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="color: rgb(0 , 0 , 0) ; font-family: &quot;helvetica&quot; ; font-size: 12px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: center ; text-indent: 0px ; text-transform: none ; white-space: normal ; word-spacing: 0px ; display: inline ; float: none ; background-color: rgb(255 , 255 , 255)">main</span></div></div></foreignObject><text x="13" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(63.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="82" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 82px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">bottom of stack</div></div></foreignObject><text x="41" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">bottom of stack</text></switch></g><path d="M 105 50 L 105 20" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(4.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 22px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">ebp</div></div></foreignObject><text x="10" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">ebp</text></switch></g><g transform="translate(4.5,93.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 20px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">esp</div></div></foreignObject><text x="10" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">esp</text></switch></g><path d="M 30 100 L 38.63 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 43.88 100 L 36.88 103.5 L 38.63 100 L 36.88 96.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 30 80 L 38.63 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 43.88 80 L 36.88 83.5 L 38.63 80 L 36.88 76.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(14.5,109.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="60" height="84" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 130px; max-width: 180px; width: 61px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1><font style="font-size: 14px">Step 1</font></h1><p>main calls f</p></div></div></foreignObject><text x="30" y="48" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="45" y="70" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(53.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="102" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 104px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">saved ebp for main</div></div></foreignObject><text x="51" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">saved ebp for main</text></switch></g><path d="M 186 70 L 181 70 Q 176 70 176 80 L 176 85 Q 176 90 171 90 L 168.5 90 Q 166 90 171 90 L 173.5 90 Q 176 90 176 100 L 176 105 Q 176 110 181 110 L 186 110" fill="none" stroke="#000000" stroke-miterlimit="10" transform="rotate(179,176,90)" pointer-events="none"/><g transform="translate(188.5,81.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="3" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="color: rgb(0 , 0 , 0) ; font-family: &quot;helvetica&quot; ; font-size: 12px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: center ; text-indent: 0px ; text-transform: none ; white-space: normal ; word-spacing: 0px ; display: inline ; float: none ; background-color: rgb(255 , 255 , 255)">f</span></div></div></foreignObject><text x="2" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="45" y="90" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(72.5,93.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">base=NULL</div></div></foreignObject><text x="32" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">base=NULL</text></switch></g><path d="M 187 50 L 182 50 Q 177 50 177 55 L 177 57.5 Q 177 60 172 60 L 169.5 60 Q 167 60 172 60 L 174.5 60 Q 177 60 177 65 L 177 67.5 Q 177 70 182 70 L 187 70" fill="none" stroke="#000000" stroke-miterlimit="10" transform="rotate(179,177,60)" pointer-events="none"/><rect x="286" y="50" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(305.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="80" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 82px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">eip for hijacked</div></div></foreignObject><text x="40" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">eip for hijacked</text></switch></g><g transform="translate(428.5,52.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="color: rgb(0 , 0 , 0) ; font-family: &quot;helvetica&quot; ; font-size: 12px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: center ; text-indent: 0px ; text-transform: none ; white-space: normal ; word-spacing: 0px ; display: inline ; float: none ; background-color: rgb(255 , 255 , 255)">main</span></div></div></foreignObject><text x="13" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(304.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="82" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 82px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">bottom of stack</div></div></foreignObject><text x="41" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">bottom of stack</text></switch></g><path d="M 346 50 L 346 20" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(245.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 22px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">ebp</div></div></foreignObject><text x="10" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">ebp</text></switch></g><g transform="translate(245.5,93.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 20px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">esp</div></div></foreignObject><text x="10" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">esp</text></switch></g><path d="M 271 100 L 279.63 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 284.88 100 L 277.88 103.5 L 279.63 100 L 277.88 96.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 271 80 L 279.63 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 284.88 80 L 277.88 83.5 L 279.63 80 L 277.88 76.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(255.5,109.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="98" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 130px; max-width: 180px; width: 180px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1><font style="font-size: 14px">Step 2</font></h1><p>f sets base to ebp with assembly and changes the saved eip</p></div></div></foreignObject><text x="90" y="55" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="286" y="70" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(294.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="102" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 104px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">saved ebp for main</div></div></foreignObject><text x="51" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">saved ebp for main</text></switch></g><path d="M 427 70 L 422 70 Q 417 70 417 80 L 417 85 Q 417 90 412 90 L 409.5 90 Q 407 90 412 90 L 414.5 90 Q 417 90 417 100 L 417 105 Q 417 110 422 110 L 427 110" fill="none" stroke="#000000" stroke-miterlimit="10" transform="rotate(179,417,90)" pointer-events="none"/><g transform="translate(429.5,81.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="3" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="color: rgb(0 , 0 , 0) ; font-family: &quot;helvetica&quot; ; font-size: 12px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: center ; text-indent: 0px ; text-transform: none ; white-space: normal ; word-spacing: 0px ; display: inline ; float: none ; background-color: rgb(255 , 255 , 255)">f</span></div></div></foreignObject><text x="2" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="286" y="90" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(318.5,93.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="54" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 54px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">base=ebp</div></div></foreignObject><text x="27" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">base=ebp</text></switch></g><path d="M 428 50 L 423 50 Q 418 50 418 55 L 418 57.5 Q 418 60 413 60 L 410.5 60 Q 408 60 413 60 L 415.5 60 Q 418 60 418 65 L 418 67.5 Q 418 70 423 70 L 428 70" fill="none" stroke="#000000" stroke-miterlimit="10" transform="rotate(179,418,60)" pointer-events="none"/><rect x="575" y="50" width="120" height="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(583.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="102" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 104px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">saved ebp for main</div></div></foreignObject><text x="51" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">saved ebp for main</text></switch></g><g transform="translate(717.5,52.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="color: rgb(0 , 0 , 0) ; font-family: &quot;helvetica&quot; ; font-size: 12px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: center ; text-indent: 0px ; text-transform: none ; white-space: normal ; word-spacing: 0px ; display: inline ; float: none ; background-color: rgb(255 , 255 , 255)">hijacked</span></div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(593.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="82" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 82px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">bottom of stack</div></div></foreignObject><text x="41" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">bottom of stack</text></switch></g><path d="M 635 50 L 635 20" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(534.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 22px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">ebp</div></div></foreignObject><text x="10" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">ebp</text></switch></g><g transform="translate(489.5,54.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 20px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">esp</div></div></foreignObject><text x="10" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">esp</text></switch></g><path d="M 515 61 L 523.63 61" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 528.88 61 L 521.88 64.5 L 523.63 61 L 521.88 57.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 560 61 L 568.63 61" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 573.88 61 L 566.88 64.5 L 568.63 61 L 566.88 57.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(544.5,109.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="126" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 130px; max-width: 180px; width: 180px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1><font style="font-size: 14px">Step 3</font></h1><p>f returns and jumps directly to hijacked. hijacked saves ebp,  but there's no return address pushed on the stack.</p></div></div></foreignObject><text x="90" y="69" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 717 50 L 712 50 Q 707 50 707 55 L 707 57.5 Q 707 60 702 60 L 699.5 60 Q 697 60 702 60 L 704.5 60 Q 707 60 707 65 L 707 67.5 Q 707 70 712 70 L 717 70" fill="none" stroke="#000000" stroke-miterlimit="10" transform="rotate(179,707,60)" pointer-events="none"/></g></svg>